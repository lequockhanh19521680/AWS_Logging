Review this code as a FinTech Architect.

Check strictly:

- Ledger ownership
- Transaction boundaries
- Idempotency
- Event publication timing
- Cross-service coupling
- Violation of architecture rules

If an issue exists:

- Explain the risk
- Reference architecture principles
- Suggest a fix
